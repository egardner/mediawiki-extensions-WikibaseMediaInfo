@import 'mediawiki.mixins';
@import '../mediainfo-variables.less';

// TODO: Is there any other way to do this?
.wbmi-item-read .wbmi-qualifier > *:not( .wbmi-qualifier-value ),
.wbmi-item-edit .wbmi-qualifier > .wbmi-qualifier-value {
	/* stylelint-disable-next-line declaration-no-important */
	display: none !important;
}

/* .wbmi-item
 *
 * The top-level block of repeatable items inside a panel. Certain sub-elements
 * appear and disappear when edit mode is toggled; flexbox is used to
 * preserve the layout while contents shift around.
 *
 */
.wbmi-item {
	.flex-display();
	margin-bottom: @hairline-spacing;

	&-container {
		.flex(1, 0, auto);
		background-color: @base90;
		border: 1px solid #eaecf0;

		// Gray row element that fills the container
		& .wbmi-entity-title {
			.flex-display();
			.flex();
			padding: @sm-spacing;
			position: relative;
			background-color: @color-background;
		}

		// Left-aligned text label inside the gray row
		// MW global styles for heading elements need to be overridden here
		& .wbmi-entity-label {
			margin: 0;
			padding: 0;
		}

		// Right-aligned text label inside the gray row
		& .wbmi-entity-label-extra {
			// adds a dot between all visible siblings
			> *:not( .wbmi-hidden ) ~ *:before {
				@bullet-separator();
			}

			.wbmi-entity-primary,
			.wbmi-entity-prominent {
				font-weight: bold;

				&.wbmi-entity-is-primary,
				&.wbmi-entity-is-prominent {
					color: @base30;

					/* stylelint-disable-next-line selector-class-pattern */
					.oo-ui-iconElement {
						min-height: 15px;
						height: 15px;
						background-size: 70%;
						filter: opacity( 0.55 );
					}
				}
			}
		}
	}

	&-content {
		margin-left: @base-spacing * 2;
		position: relative;

		&:before {
			@vertical-line();
		}

		&-group {
			padding: @sm-spacing;

			// If an empty .wbmi-content-group element is the only child of its
			// parent (.wbmi-item-content) -- a state which corresponds to the
			// panel being in reading state when no qualifiers exist -- collapse
			// the padding so that the grandparent's border (.wbmi-item) does not
			// wrap around empty space.
			&:only-child:empty {
				padding: 0;
			}
		}
	}

	// Trash-can button; lives outside of .wbmi-container
	&-remove {
		.flex(0, 1, auto);
	}

	// Add-qualifier button. It is nudged up by an amount equal to the padding
	// along one side of its previous sibling, .wbmi-item-content-group`
	&-qualifier-add {
		position: relative;
		top: -( @sm-spacing );

		&:before {
			@horizontal-line();
		}

		// OOUI override...
		/* stylelint-disable-next-line selector-class-pattern */
		&.oo-ui-buttonElement > .oo-ui-buttonElement-button {
			font-weight: normal;
		}
	}
}
